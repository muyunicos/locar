<!DOCTYPE html>
<html lang="es">
<head>
    <style> /* Estilos rápidos para el menú hamburguesa */
        .nav-header { display: flex; justify-content: space-between; align-items: center; }
        .hamburger-button { font-size: 2em; cursor: pointer; background: none; border: none; }
        .nav-panel { display: none; position: fixed; top: 0; right: 0; width: 250px; height: 100%; background: #fff; box-shadow: -2px 0 5px rgba(0,0,0,0.2); z-index: 1000; }
        .nav-panel.open { display: block; }
        .nav-panel ul { list-style: none; padding: 20px; }
        .nav-panel li a { display: block; padding: 10px; color: #333; text-decoration: none; }
    </style>
</head>

<body ...>

    <div class="nav-panel" id="nav-panel">
        <ul>
            <?php foreach ($navigable_modules as $navModule): ?>
                <li>
                    <a href="#" class="nav-link" data-module-id="<?= htmlspecialchars($navModule['id']) ?>">
                        <?= htmlspecialchars($navModule['title']) ?>
                    </a>
                </li>
            <?php endforeach; ?>
        </ul>
    </div>

    <div id="app-container">
        <header class="nav-header">
            <h1 id="page-main-title"><?= htmlspecialchars($page_title) ?></h1>
            <button class="hamburger-button" id="hamburger-button">&#9776;</button>
        </header>
        <main id="module-content-wrapper">
            <?= $content /* El contenido inicial del módulo se inyecta aquí */ ?>
        </main>
    </div>

    <script src="/asset/js/event-handler.js"></script>
    <script>
    // Lógica para el menú de navegación
    document.addEventListener('DOMContentLoaded', () => {
        const navPanel = document.getElementById('nav-panel');
        const hamburgerBtn = document.getElementById('hamburger-button');
        const appContainer = document.getElementById('module-content-wrapper');

        hamburgerBtn.addEventListener('click', () => navPanel.classList.toggle('open'));

        navPanel.addEventListener('click', async (e) => {
        if (e.target.classList.contains('nav-link')) {
            e.preventDefault();
            const moduleId = e.target.dataset.moduleId;
            const clientId = '<?= $client_id ?>'; // Inyectamos el ID de cliente desde PHP
            
            // Muestra un estado de carga
            appContainer.innerHTML = '<h2>Cargando...</h2>';
            navPanel.classList.remove('open');
            
            try {
                const response = await fetch(`../api/getModule.php?client=<span class="math-inline">\{clientId\}&id\=</span>{moduleId}`);
                if (!response.ok) {
                    throw new Error(`Error en la respuesta de la API: ${response.statusText}`);
                }
                const newHtml = await response.text();
                appContainer.innerHTML = newHtml;
            } catch (error) {
                console.error('Error al cargar el módulo:', error);
                appContainer.innerHTML = `<div class='app-error'>No se pudo cargar el módulo. Inténtalo de nuevo más tarde.</div>`;
            }
        }
    });
    });
    </script>
</body>
</html>